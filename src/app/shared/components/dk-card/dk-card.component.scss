@import '../../../../styles/abstracts/variables';
@import '../../../../styles/abstracts/mixins';

.card {
  @include card-base;
  position: relative;
  overflow: hidden;
  
  // Variants
  &--default {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
  }
  
  &--glass {
    @include card-glass;
  }
  
  &--outlined {
    background: transparent;
    border: 2px solid var(--color-border);
    box-shadow: none;
  }
  
  &--elevated {
    background: var(--color-surface);
    border: none;
    box-shadow: var(--shadow-lg);
  }
  
  // Interactive states
  &--hoverable {
    @include card-hover;
  }
  
  &--clickable {
    cursor: pointer;
    user-select: none;
    
    &:hover {
      transform: translateY(-2px) scale(1.01);
      box-shadow: var(--shadow-xl);
    }
    
    &:active {
      transform: translateY(-1px) scale(1.005);
      box-shadow: var(--shadow-lg);
      transition-duration: 0.1s;
    }
  }
  
  &--loading {
    pointer-events: none;
    position: relative;
    
    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--color-surface);
      opacity: 0.8;
      z-index: 10;
    }
    
    &::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 24px;
      height: 24px;
      margin: -12px 0 0 -12px;
      border: 2px solid var(--color-primary);
      border-radius: $radius-full;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
      z-index: 11;
    }
  }
}

// Card header
.card-header {
  margin-bottom: $space-4;
  
  &:not(:first-child) {
    padding-top: $space-4;
    border-top: 1px solid var(--color-border);
  }
}

.card-title {
  @include heading($text-lg, $font-semibold);
  margin: 0;
  color: var(--color-text-primary);
}

.card-subtitle {
  @include body($text-sm, $font-normal);
  margin: $space-1 0 0 0;
  color: var(--color-text-muted);
}

// Card content
.card-content {
  flex: 1;
  
  // Reset margins for common elements
  > :first-child {
    margin-top: 0;
  }
  
  > :last-child {
    margin-bottom: 0;
  }
  
  p {
    @include body($text-sm, $font-normal);
    color: var(--color-text-secondary);
  }
  
  h1, h2, h3, h4, h5, h6 {
    color: var(--color-text-primary);
    
    &:first-child {
      margin-top: 0;
    }
  }
}

// Card actions
.card-actions {
  @include flex-between;
  margin-top: $space-4;
  padding-top: $space-4;
  border-top: 1px solid var(--color-border);
  gap: $space-2;
  
  &:empty {
    display: none;
  }
}

// Skeleton loading effect for card content
.card--loading .card-content {
  .skeleton {
    background: linear-gradient(
      90deg,
      var(--color-surface-alt) 25%,
      var(--color-surface) 50%,
      var(--color-surface-alt) 75%
    );
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s infinite;
    border-radius: $radius;
    height: 1rem;
    margin-bottom: $space-2;
    
    &:last-child {
      margin-bottom: 0;
      width: 60%;
    }
  }
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

// Responsive adjustments
@include max-mobile {
  .card {
    padding: $space-4;
    
    .card-title {
      font-size: $text-base;
    }
  }
  
  .card-actions {
    flex-direction: column;
    
    > * {
      width: 100%;
    }
  }
}

// Accessibility improvements
@media (prefers-reduced-motion: reduce) {
  .card {
    transition: none;
    
    &--hoverable,
    &--clickable {
      &:hover {
        transform: none;
      }
    }
    
    &--loading {
      &::before {
        animation: none;
        border: 2px solid var(--color-primary);
      }
    }
  }
  
  .skeleton {
    animation: none !important;
    background: var(--color-surface-alt) !important;
  }
}

// High contrast mode support
@media (prefers-contrast: high) {
  .card {
    border: 2px solid;
    
    &--default {
      border-color: var(--color-text-primary);
    }
    
    &--glass {
      border-color: var(--color-text-primary);
      backdrop-filter: none;
      background: var(--color-surface);
    }
  }
}

// Print styles
@media print {
  .card {
    border: 1px solid black !important;
    box-shadow: none !important;
    background: white !important;
    
    &--loading {
      &::after,
      &::before {
        display: none;
      }
    }
  }
  
  .card-title {
    color: black !important;
  }
  
  .card-subtitle,
  .card-content {
    color: black !important;
  }
}